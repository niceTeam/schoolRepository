<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>考试云首页</title>
    <link rel="stylesheet" type="text/css" href="../font-awesome-4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">-->
    <link rel="stylesheet" href="../dist/sidebar-menu.css">
    <link rel="stylesheet" href="../css/sy.css">
    <style type="text/css">
        .main-sidebar{
            position: fixed;
            top: 10%;
            left: 0;
            height: 100%;
            min-height: 100%;
            width: 180px;
            z-index: 10;
            background-color: #222d32;

        }
       .xskxmb .mbmc{
        overflow: hidden; text-overflow:ellipsis;  white-space: nowrap;width: 100px;
        }
         .tmlx input{
            padding: 4px 20px;
            border: 1px solid #2fa0ec;
            color: #2fa0ec;
            background-color: white;
            border-radius: 5px;
        }
        header{
            height: 10%;
            width: 100%;
            position: fixed;
            background-image: url("../image/dhbj.jpg");
            background-size: 200px 150px;
            top: 0;z-index: 12;
            font-size: 25px;
            font-family: 幼圆;
            -webkit-box-shadow: -4px 6px 5px -4px #cfcfcf;
        }
        header a{color: black}
        header .glymc{font-size: 17px;}
        header .tcdl{font-size: 17px;}
        .bgbk{border: 1px solid #0088DB;}
        .bgbk2{border: 1px solid #0088DB;}
        .ygzsd{border-color:#7c7c7cbd;background-color: white;}
    </style>

</head>
<body style="  background-color: #e6ecee;">

<div class="stfw" style="display: none">
    <div style="text-align: center;font-size: 20px">选择范围</div>
    <div style="overflow: auto;height: 480px">
    <ul class="shuml">
        <li>
            <i class="fa fa-plus-square-o" onclick="dj(this)"></i> <label>📚 第一本书</label>
            <ul class="zjml">
                <li>
                    <i class="fa fa-plus-square-o"></i> <label>📃123</label>
                    <ul class="zsdml">
                        <li><label>📑 bcd</label></li>
                        <li><label>📑 sec</label></li>
                        <li><label>📑 hfw</label></li>
                    </ul>
                </li>
                <li><i class="fa fa-plus-square-o"></i> <label>📃 234</label></li>
                <li><i class="fa fa-plus-square-o"></i> <label>📃 345</label></li>
            </ul>
        </li>
        <li>
            <i class="fa fa-plus-square-o"></i> <label>📚 第二本书</label>
            <ul class="zjml">
                <li>
                    <i class="fa fa-plus-square-o"></i> <label>📃 123</label>
                </li>
                <li>
                    <i class="fa fa-plus-square-o"></i> <label>📃 345</label>
                    <ul class="zsdml">
                        <li><label>📑 bcd</label></li>
                        <li><label>📑 sec</label></li>
                        <li><label>📑 hfw</label></li>
                    </ul>
                </li>
                <li><i class="fa fa-plus-square-o"></i> <label>📃 345</label></li>
            </ul>
        </li>
    </ul>
    </div>
    <div style="margin-top: 10px">
        <input type="button" value="选择" class="xz"> <input type="button" value="关闭" class="gb">
    </div>
</div>

<div class="ctfw" style="display: none;">
    <div style="text-align: center;font-size: 20px">选择范围</div>
    <div style="overflow: auto;height: 480px">
        <ul class="shuml">
            
        </ul>
    </div>
    <div style="margin-top: 10px">
        <input type="button" value="选择" class="xz"> <input type="button" value="关闭" class="gb">
    </div>
</div>

<div class="cyy" style="display:none; "></div>

<div class="xzkssj" style="display: none">
    <div style="text-align: center;font-size: 25px">选择试卷</div>
    <div>
        <div style="margin-top: 20px">试卷名称：<input type="text" class="sjmc"><input type="button" value="搜索" class="ss"></div>
        <div style="border-bottom: 1px solid #0088DB;margin: 20px 0"></div>
        <div style="height: 300px;overflow: auto;margin-left: 30px;padding: 0 2px">
            <table class="sjtb">
                <tr>
                    <td  style="width: 50px;height: 50px"></td>
                    <td  style="width: 250px;">名称</td>
                    <td style="width: 150px">总分</td>
                    <td style="width: 150px">创建人</td>
                    <td style="width: 190px">创建时间</td>
                </tr>
               
               <!-- 显示所有试卷 -->
               
            </table>
        </div>
        <div> <input type="button" value="保存" class="bc" onclick="gbxgkssj(this)"><input type="button" value="关闭" class="gb" onclick="gbxgkssj(this)"></div>
    </div>
</div>

<header>
    <div style="margin-top: 15px;">
        <label style="font-weight: 200;margin-left: 650px">考试云</label>
        <a style="margin-left: 250px"><i class="fa fa-user" style="font-size: 20px"></i></a>
        <a class="glymc" th:text="${uname}"></a>
        <span th:text="${uid}" class="uid" style="display: none"></span>
        <a style="margin-left: 30px"><i class="fa fa-power-off"></i></a>
        <a class="tcdl" href="dl">退出</a>
    </div>
</header>

<div class="bjjyfbdsj" style="display: none">
    <div class="tmzsdzj">
        <div class="zongji">总题数：<span class='t'>10</span> 题，总分数：<span class="f">100</span> 分</div>
        <div class="zsdzl">
            <p style="font-size: 17px;margin-bottom: 15px;">知识点一</p>
           <p style="margin-bottom: 15px;margin-left: 20px"> 共 &nbsp;<input type="text" style="width: 30px;height: 20px"> &nbsp;题 ，共 10 分</p>
            <p><a>换题</a><a>换知识点</a></p>
        </div>
    </div>

    <div class="tmmk">
       <div class="zsdsytm">
        <p class="zsd">知识点一</p>
        <div>
            <p style="margin-left: 0">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。(5分)</p>
            <p><i class="fa fa-square-o"></i> A.左侧</p>
            <p><i class="fa fa-check-square-o"></i> B.左侧</p>
            <p><i class="fa fa-check-square-o"></i> C.左侧</p>
            <p><i class="fa fa-check-square-o"></i> D.左侧</p>
            <p style="color: #656262c9">答案：A  &nbsp;解析：这么简单都不知道？</p>
        </div>
        <div>
            <p style="margin-left: 0">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。(5分)</p>
            <p><i class="fa fa-square-o"></i> A.左侧</p>
            <p><i class="fa fa-check-square-o"></i> B.左侧</p>
            <p><i class="fa fa-check-square-o"></i> C.左侧</p>
            <p><i class="fa fa-check-square-o"></i> D.左侧</p>
            <p style="color: #656262c9">答案：A  &nbsp;解析：这么简单都不知道？</p>
        </div>
    </div>

        <div class="zsdsytm">
            <p class="zsd">知识点二</p>
            <div>
                <p style="margin-left: 0">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。(5分)</p>
                <p><i class="fa fa-square-o"></i> A.左侧</p>
                <p><i class="fa fa-check-square-o"></i> B.左侧</p>
                <p><i class="fa fa-check-square-o"></i> C.左侧</p>
                <p><i class="fa fa-check-square-o"></i> D.左侧</p>
                <p style="color: #656262c9">答案：A  &nbsp;解析：这么简单都不知道？</p>
            </div>
            <div>
                <p style="margin-left: 0">在机场、商厦、地铁等公共场所乘自动扶梯时应靠（）站立,另一侧供有急事赶路的人快行。(5分)</p>
                <p><i class="fa fa-square-o"></i> A.左侧</p>
                <p><i class="fa fa-check-square-o"></i> B.左侧</p>
                <p><i class="fa fa-check-square-o"></i> C.左侧</p>
                <p><i class="fa fa-check-square-o"></i> D.左侧</p>
                <p style="color: #656262c9">答案：A  &nbsp;解析：这么简单都不知道？</p>
            </div>
        </div>
    </div>
</div>

<aside class="main-sidebar">
    <section  class="sidebar">
        <ul class="sidebar-menu">
            <li class="header">导航</li>
            <li class="treeview" onclick="shouye(this)">
                <a href="#">
                    <i class="fa fa-home"></i> <span >首页</span>
                </a>
            </li>

            <li class="treeview">
                <a href="#">
                    <i class="fa fa-file-text-o"></i>
                    <span>考试管理</span>
                    <i class="fa fa-angle-left pull-right"></i>
                </a>
                <ul class="treeview-menu">
                    <li><a href="#" onclick="kaoshiguanli(this)"> 考试信息管理</a></li>
                    <li><a href="#" onclick="shitiku(this)"> 试题库</a></li>
                    <li><a href="#" onclick="shijuaku(this)"> 试卷库</a></li>
                    <li><a href="#"> 成绩查询</a></li>
                    <li><a href="#"> 统计分析</a></li>
                </ul>
            </li>
            <li class="treeview">
                <a href="#">
                    <i class="fa fa-user-o"></i> <span>人员管理</span>
                    <i class="fa fa-angle-left pull-right"></i>
                </a>
                <ul class="treeview-menu">
                    <li><a href="#"> 考生信息</a></li>
                    <li><a href="#"> 注册管理</a></li>
                </ul>
            </li>

            <li class="treeview">
                <a href="#">
                    <i class="fa fa-graduation-cap"></i>
                    <span>学习</span>
                    <i class="fa fa-angle-left pull-right"></i>
                </a>
                <ul class="treeview-menu">
                    <li><a href="#">知识库</a></li>
                    <li><a href="#">课程管理</a></li>
                    <li><a href="#">学习纪录</a></li>
                </ul>
            </li>
            <li class="treeview">
                <a href="#">
                    <i class="fa fa-gear"></i>
                    <span>系统管理</span>
                    <i class="fa fa-angle-left pull-right"></i>
                </a>
                <ul class="treeview-menu">
                    <li><a href="#">子管理员设置</a></li>
                    <li><a href="#">个性化设置</a></li>
                    <li><a href="#">管理员操作纪录</a></li>
                </ul>
            </li>

            <li>
                <a href="#">
                    <i class="fa fa-shield"></i> <span>认证中心</span>
                    <small class="label pull-right label-danger">BETA</small>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-envelope"></i> <span>Mailbox</span>
                    <small class="label pull-right label-warning">ATC</small>
                </a>
            </li>

        </ul>
    </section>
    <section style="position: fixed;top: 92%;">
        <ul class="sidebar-menu">   <li class="treeview">
            <a href="#">
                <i class="fa fa-question-circle-o"></i> <span>帮助</span>
            </a>
        </li></ul>
    </section>
</aside>

<div class="neirong">

    <div id="shouye" style="display: block;">
       <div class="sygl">
           <div class="cjks"  onclick="chuangjiankaoshi(this)" onmouseover="xsyd(this)" onmouseout="xxyd(this)">
           <div><img src="../image/cjks.jpg"></div>
               <div>
                   <h4>创建考试</h4>
                   <p>可选择创建新试卷，或从试卷的库中选择一张试卷</p>
               </div>
           </div>

           <div class="cjks" onmouseover="xsyd(this)" onmouseout="xxyd(this)" onclick="tianjiashiti(this,1)">
               <div><img src="../image/tjst.jpg"></div>
               <div>
                   <h4>添加试题</h4>
                   <p>手动录入试题，完善您的试题库</p>
               </div>
           </div>

           <div class="cjks" onmouseover="xsyd(this)" onmouseout="xxyd(this)">
               <div><img src="../image/tjry.jpg"></div>
               <div>
                   <h4>添加人员</h4>
                   <p>填写账号信息和人员信息，添加管理员</p>
               </div>
           </div>

           <div class="cjks" onmouseover="xsyd(this)" onmouseout="xxyd(this)" >
               <div><img src="../image/cjkc.jpg"></div>
               <div>
                   <h4>创建课程</h4>
                   <p>填写课程相关信息</p>
               </div>
           </div>
       </div>

        <div style="margin-left: 20px;margin-top: 20px"><h4>正在进行<a style="margin-left: 950px;font-size: 15px">展开更多</a></h4></div>

        <div class="zzjx">
         
            <div style="margin: 60px 0 50px 400px;color: #8c8c8c;">还没有正在进行的考试，点击上方创建一场考试吧~~</div>
        </div>

        <div style="margin-left: 20px;margin-top: 20px"><h4>即将开始<a style="margin-left: 950px;font-size: 15px" calss="xssyjjks">展开更多</a></h4></div>
        <div class="jjks">
         	<!-- 即将开始的考试  -->
        </div>

    </div >

    <div id="tjst" style="display: none;">
        <div style="position: absolute;margin-top: -10px;margin-left: 850px">
            <input type="button" value="重置"  class="czst">
            <input type="button" value="录入"  class="lrst" >
        </div>

        <div class="tmlx">
            试题分类：
            <select class="stfl">
                 <option value="1">S1</option>
            </select>
             <input type="button" value="选择知识点">
            &nbsp; &nbsp; &nbsp; &nbsp;
            试题类型：
            <select class="stlx">
                <option value="1">单选</option>
                <option value="2">多选</option>

            </select>
        </div>

        <div class="ctnr">
            <div class="timunr">
                <input type="button" value="题干" >
                <a>这里填写题目的描述</a>
            </div>
            <textarea class="tigan" onfocus="srtg(this)" onblur="tgwc(this)"></textarea>

        </div>

        <div class="ctnr">
            <div class="timunr">
                <input type="button" value="选项" >
                <a>单/多选题的范围从 2 到 20 </a>
            </div>
            

            <div class="mrxx">
            
            <div class="xuanx">
                <div><input type="radio" name="y"></div><textarea class="xuanxiang" onfocus="srxx(this)" onblur="xxwc(this)"></textarea>
            </div>
            
            <div class="xuanx">
                <div><input type="radio" name="y"></div><textarea class="xuanxiang" onfocus="srxx(this)" onblur="xxwc(this)"></textarea>
            </div>

            <div class="xuanx">
                <div><input type="radio" name="y"></div><textarea class="xuanxiang" onfocus="srxx(this)" onblur="xxwc(this)"></textarea>
                <div class="qxxx" onclick="scxx(this)">x</div>
            </div>

            <div class="xuanx">
                <div><input type="radio" name="y"></div><textarea class="xuanxiang" onfocus="srxx(this)" onblur="xxwc(this)"></textarea>
                <div class="qxxx" onclick="scxx(this)">x</div>
            </div>

            </div>


            <div class="tjygxx">
                <input type="button" value="添加一个选项" onclick="tjygxx(this)">
            </div>



            <div class="timujx">
                <input type="button" value="解析" >
                <a>这里填写该问题对应的答案解析 </a>
            </div>

            <div><textarea class="jiexi" onfocus="srjx(this)" onblur="jxwc(this)"></textarea></div>

        </div>



    </div>

    <div id="shitk" style="display:none;">
        <div class="stktb">
            <input type="button" value="≡ 添加试题" class="tjst" onclick="tianjiashiti(this,1)">
        </div>

        <div style="position: absolute;margin-top: -40px;margin-left: 130px">
            <select class="stlx">
                <option value="1">单选</option>
                <option value="2">多选</option>
            </select>
        </div>

        <div  style="position: absolute;margin-top: -40px;margin-left: 225px">
            <input type="button" value="刷新" class="sxstk">
            <input type="button" value=" 删除" class="plscst">
        </div>

        <div style="position: absolute;margin-top: -40px;margin-left: 850px">
            <input type="text" class="ssuost" placeholder="搜索试题">
            <div style="position: absolute;margin-left: 210px;margin-top: -25px">
                <i class="fa fa-search"></i>
            </div>
        </div>

        <div style="background-color: white;margin-top: 10px" >
            <div>
                <table class="stbt">
                    <tr>
                        <td style="width: 60px;text-align: center"><input type="checkbox" onclick="ckAll(this)" class="cks"></td>
                        <td  style="width: 100px">题型</td>
                        <td style="width: 200px">分类</td>
                        <td style="width: 350px">试题内容</td>
                        <td style="width: 150px">创建人</td>
                        <td style="width: 200px">创建时间</td>
                        <td style="width: 90px">操作</td>
                    </tr>
                </table>
            </div>

            <div style="margin-top: 10px;height: 370px;" class="xssyst">
                <table class="stbt">
                <!-- 试题内容  -->
                </table>
            </div>
            <div style="padding:20px;color: #515151d9;margin-bottom: 20px;text-align: center">
                 <input type="button" value="上一页" data-val="1" id="prePage">
                &nbsp;<span id="currentPage">1 / 2</span>&nbsp;
                <input type="button" value="下一页" data-val="1" id="nextPage">&nbsp;&nbsp;&nbsp;
                                       跳到第 <input type="text" style="width: 50px" class="fanye"> 页
            </div>
        </div>


    </div>

    <div id="shijk" style="display: none;">
        <div class="sjktb">
            <input type="button" value="试卷预览" class="sjyl" onclick="shijuanyl(this)">
        </div>

        <div  style="position: absolute;margin-top: -40px;margin-left: 130px">
            <input type="button" value="刷新" class="sxstk">
            <input type="button" value=" 删除" class="plscst">
        </div>

        <div style="position: absolute;margin-top: -40px;margin-left: 850px">
            <input type="text" class="sssj" placeholder="搜索试卷">
            <div style="position: absolute;margin-left: 210px;margin-top: -25px">
                <i class="fa fa-search"></i>
            </div>
        </div>

        <div style="background-color: white;margin-top: 10px" >
            <div>
                <table class="sjbtou">
                    <tr>
                        <td style="width: 80px;text-align: center"><input type="checkbox" onclick="ckAll(this)" class="cks"></td>
                        <td  style="width: 150px">名称</td>
                        <td style="width: 150px">题目数量</td>
                        <td style="width: 150px">试卷总分</td>
                        <td style="width: 150px">创建人</td>
                        <td style="width: 230px">创建时间</td>
                        <td style="width: 150px">使用次数</td>
                        <td style="width: 90px">操作</td>
                    </tr>
                </table>
            </div>

            <div style="margin-top: 10px;height: 380px;" class="sjdiv">
                <table class="sjbsj">
                   <!-- 试卷库内容 -->
                </table>
            </div>
            <div style="padding:20px;color: #515151d9;margin-bottom: 20px;text-align: center">
                 <input type="button" value="上一页" data-val="1" id="prePage2">
                &nbsp;<span id="currentPage2">1 / 2</span>&nbsp;
                <input type="button" value="下一页" data-val="1" id="nextPage2">&nbsp;&nbsp;&nbsp;
                                       跳到第 <input type="text" style="width: 50px" class="fanye2"> 页
            </div>
        </div>

    </div>

    <div id="cjks" style="display: none" >
        <div class="cjksbz">
            <a class="dyb">第一步：创建考试</a>
            <a class="drb">第二步：添加试题</a>
            <a class="dsb">第一步：发布考试</a>
        </div>

        <div class="cjsjbj" >
            <div  class="div1" style="display: flex" >
                <div class="cjxsj">
                   <h4>创建新试卷</h4>
                    <table style="margin-top: 10px;margin-left: 20px">
                        <tr>
                            <td style="height: 95px;width: 90px">试卷名称:</td>
                            <td>  <input type="text" class="sjmc" placeholder="输入试卷名称"></td>
                        </tr>
                     
                        <tr>
                            <td></td>
                            <td  style="height: 70px;">
                                <input type="button" value="下一步" class="cjxsjxyb" style="margin-left: 130px">
                            </td>
                        </tr>
                    </table>
                </div>

                <div style="height: 260px;border: 1px solid #CDCDCD;margin-top: 50px;margin-left: 20px"></div>

                 <div class="xzyysj">
                     <h4>选择已有试卷</h4>
                     <div class="xzsjcj"><input type="button" value="选择试卷" onclick="ghjyksdsj(this)"></div>

                     <input type="button" value="下一步" class="xzyysjxyb">
                 </div>

            </div>

            <div class="xtzj" style="display: none;overflow: auto;height: 450px">
            <div class="tjtmdh" >
               <div class="yymb">
                   <i class="fa fa-circle-o"></i>
                   <label> 选择已有模板</label>
               </div>
                <div class="div3" style="display: none">
                    <div style="display: flex">
                    <div class="ssmb">
                        <p>选择的模板：<input type="text" readonly="readonly"></p>
                        <p><input value="下一步" type="button" onclick="ymbcjsj(this)"></p>
                    </div>

                    <div >
                        <div style="border: 1px solid #CDCDCD;padding: 3px 15px;border-radius: 15px;width: 205px;margin-bottom: 10px">
                            <input type="text" class="cx" placeholder="搜索模板">&nbsp;
                            <i class="fa fa-search"></i>
                        </div>
                     <div style="height: 200px;overflow: auto;border: 1px solid #CDCDCD;">
                     	<table class="xskxmb">
                        	<!-- 模板内容  -->                
                   		</table>
                     </div>
                    </div>
                    </div>
                </div>
            </div>

            <div class="xjmb">
                <div class="xmb">
                    <i class="fa fa-check-circle"></i>
                    <label> 创建新模板</label>
                </div>

                <div class="cjmbnr">
                    <div style="display: flex;margin-top: 10px">
                        <div>
                         <p class="mbmc">模板名称: <input type="text"></p>
                         <p class="ssnj">所属年级: <select>
                             <option value="0">全年级</option>
                             <option value="1">sl</option>
                             <option value="2">s2</option>
                             <option value="3">s3</option>
                         </select></p>
                         <p class="ksfw">考试范围: <input type="button" value="全年级" onclick="xzstfw(this,1)" zsdid='0' kcid='0' zjid='0'></p>
                         <p class="cssc">考试时长: <input type="text" style="width: 60px;padding-left: 10px">&nbsp;分钟</p>
                         <p class="mtfs">每题分数: <input type="text" style="width: 60px;padding-left: 10px">&nbsp;分</p>
                        </div>

                        <div class="timu">
                            <div class="zsdtm">
                            书本：<select class="sb" onclick="sbchange(this)">
                                    <option>选择课程</option>
                                  </select>&nbsp;
                            章节：<select class="zj" onclick="zjchange(this)">
                                    <option>选择课程</option>
                                  </select>&nbsp;
                            知识点：<select class="zsd">
                                        <option>选择章节</option>
                                  </select>
                                <div style="margin-top: 5px">题数：<input type="text" style="width: 100px;padding-left: 10px"></div>
                            </div>

                            <div class="zsdtm">
                                书本：<select class="sb" onclick="sbchange(this)">
                                <option>选择课程</option>
                            </select>&nbsp;
                                章节：<select class="zj" onclick="zjchange(this)">
                                <option>选择课程</option>
                            </select>&nbsp;
                                知识点：<select class="zsd">
                                <option>选择章节</option>
                            </select>
                                <div style="margin-top: 5px">
                                    题数：<input type="text" style="width: 100px;padding-left: 10px">
                                </div>
                                <div style="margin-left: 520px;margin-top: -20px;">
                                    <i class="fa fa-close" onclick="scst(this)"></i>
                                </div>
                            </div>
                        
                        </div>
                    </div>
                    <div class="div2">
                        <input type="button" value="增加试题" class="zjst" onclick="zsst(this)">
                        <input type="button" value="下一步" class="xyb"></div>
                </div>
            </div>


    </div>

            <div class="fbks" style="display: none">
                <div class="ksxxxx">
                    <table  style="margin-left: 40px;margin-top: 20px">
                        <tr>
                            <td style="width: 100px;">选择班级</td>
                            <td style="width: 400px">
	                            <select class="ksbj">
	                                <option>1713</option>
	                            </select>
                            </td>                            
                        </tr>
                        <tr>
                            <td>考试班级</td>
                            <td class="ksfl">
                            	<input type="text" readonly="readonly">
                            	&nbsp;&nbsp;
                            	<label onclick="cxbj(this)"><a>重选班级</a></label>
                            </td>
                        </tr>
                        <tr>
                            <td>考试时间</td>
                            <td><input type="datetime-local" class="kssj" onblur="jsjssj(this)"> 到 <input type="datetime-local" class="jssj"></td>
                        </tr>
                        <tr>
                            <td>及格分数</td>
                            <td><input type="text"></td>
                        </tr>
                        <tr>
                            <td>考试说明</td>
                            <td rowspan="3"><textarea class="kssm"></textarea></td>
                        </tr>
                        <tr>
                            <td></td>

                        </tr>
                        <tr>
                            <td></td>

                        </tr>
                    </table>
                </div>
                <div class="sjxxxx" style="margin-left: 30px;margin-top: 40px">
                    <label style="background-color: blue;width: 7px;color: blue" >|</label>
                    <label style="margin-left: 5px;">试卷信息</label>
                    <table  >
                        <tr>
                            <td colspan="2" style="height: 40px;color: black;border-bottom:1px solid #CDCDCD;background-color: #eaecec61">
                                <span class="fbsjmc">试卷名称</span>
                            <a style="margin-left: 330px" onclick="bjsj(this,0,0)" zt="2">编辑试卷 <i class="fa fa-pencil"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>总分:</td>
                            <td class="fbsjzf">100</td>
                        </tr>
                        <tr>
                            <td>创建人:</td>
                            <td class="fbcjr">考试星</td>
                        </tr>
                        <tr>
                            <td>试题数量:</td>
                            <td class="fbstsl">50</td>
                        </tr>
                        <tr>
                            <td>创建时间:</td>
                            <td class="fbcjsj">2018-02-10 11:20</td>
                        </tr>
                    </table>
                </div>
                <div class="fabu"><input type="button" value="发布考试" onclick="fbks(this)">
                <input type="button" value="试卷预览" class="sjyls2" style="border: 1px solid #0088cc;background-color: white;color: #0088cc;padding: 4px 25px">
                </div>
            </div>

        </div>
    </div>

    <div id="bjsj" style="display: none;">
        <div class="bjjyfbdsj">
            <div class="fh"><i class="fa fa-caret-left"></i> &nbsp;<a>返回</a></div>
            <div class="sjmc">试卷名称</div>
            <div class="yn">
                <input type="button" value="保存">
                <input type="button" value="取消">
            </div>
            <div class="tmzsdzj">
                <div class="zongji">总题数：<label class='t'></label> 题，总分数：<label class='f'></label> 分</div>
                <div id="zsdlb">
	                     <!-- 知识点列表 -->
	            </div>
	            
            </div>

            <div class="tmmk">
               		<!-- 知识点题目详情  -->     
            </div>
        </div>
    </div>

    <div id="bjks" style="display: none">
        <div class="fbks" style="display: flex">
            <div class="ksxxxx">
                <table  style="margin-left: 40px;margin-top: 20px">
                    <tr>
                        <td style="width: 100px;">考试班级</td>
                        <td style="width: 400px"><select class="ksbj">
                            <option>1713</option>
                           
                        </select></td>
                    </tr>
                    <tr>
                        <td>考试班级</td>
                        <td class="ksfl">
                        	<input type="text" readonly="readonly">
                        	<label onclick="cxbj(this)"><a>重选班级</a></label>
                        </td>
                    </tr>
                    <tr>
                        <td>考试时间</td>
                        <td><input type="datetime-local" class="kssj"> 到 <input type="datetime-local" class="jssj"></td>
                    </tr>
                    <tr>
                        <td>及格分数</td>
                        <td><input type="text"></td>
                    </tr>
                    <tr>
                        <td>考试说明</td>
                        <td rowspan="3"><textarea class="kssm"></textarea></td>
                    </tr>
                    <tr>
                        <td></td>

                    </tr>
                    <tr>
                        <td></td>
                    </tr>
                </table>
            </div>
            <div class="sjxxxx" style="margin-left: 30px;margin-top: 40px">
                <label style="background-color: blue;width: 7px;color: blue" >|</label>
                <label style="margin-left: 5px;">试卷信息</label>
                <table>
                     <tr>
                            <td colspan="2" style="height: 40px;color: black;border-bottom:1px solid #CDCDCD;background-color: #eaecec61">
                                <span class="fbsjmc">试卷名称</span>
                            <a style="margin-left: 330px" onclick="bjsj(this,0,0)" zt="3">编辑试卷 <i class="fa fa-pencil"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>总分:</td>
                            <td class="fbsjzf">100</td>
                        </tr>
                        <tr>
                            <td>创建人:</td>
                            <td class="fbcjr">考试星</td>
                        </tr>
                        <tr>
                            <td>试题数量:</td>
                            <td class="fbstsl">50</td>
                        </tr>
                        <tr>
                            <td>创建时间:</td>
                            <td class="fbcjsj">2018-02-10 11:20</td>
                        </tr>
                        
                        <tr>
                        	<td colspan="2" style="text-align: center"><input type="button" value="更换试卷" class="ghsj" onclick="ghjyksdsj(this)"></td>
                   		</tr>
                </table>

            </div>
            <div class="fabu"><input type="button" value="保存修改" onclick="bcxg()">
                <input type="button" value="返回主页" class="fhzy" onclick="shouye(this)" style="border: 1px solid #0088cc;background-color: white;color: #0088cc;padding: 4px 25px">
            </div>
        </div>
    </div>


	 <div id="ksgl" style="display: none;">
        <div class="stktb">
            <input type="button" value="创建考试" class="cjks" >
        </div>

        <div  style="position: absolute;margin-top: -40px;margin-left: 200px">
            <input type="button" value="刷新" class="sxstk">
            <input type="button" value=" 删除" class="plscst">
        </div>

        <div style="position: absolute;margin-top: -40px;margin-left: 850px">
            <input type="text" class="ssuost" placeholder="查询考试">
            <div style="position: absolute;margin-left: 210px;margin-top: -25px">
                <i class="fa fa-search"></i>
            </div>
        </div>

        <div style="background-color: white;margin-top: 10px" >
            <div>
                <table class="stbt">
                    <tr>
                        <td style="width: 60px;text-align: center"><input type="checkbox" onclick="ckAll(this)" class="cks"></td>
                        <td  style="width: 150px">考试名称</td>
                        <td style="width: 120px">总分</td>
                        <td style="width: 150px">题目数量</td>
                        <td style="width: 150px">创建人</td>
                        <td style="width: 200px">开始时间</td>
                        <td style="width: 200px">结束时间</td>
                        <td style="width: 150px">操作</td>
                    </tr>
                </table>
            </div>

            <div style="margin-top: 10px;height: 370px;" class="xssyst">
                <table class="stbt">

                </table>
            </div>

            <div style="padding:20px;color: #515151d9;margin-bottom: 20px;text-align: center">
                 <input type="button" value="上一页" data-val="1" id="prePage3">
                &nbsp;<span id="currentPage3">1 / 2</span>&nbsp;
                <input type="button" value="下一页" data-val="1" id="nextPage3">&nbsp;&nbsp;&nbsp;
                                       跳到第 <input type="text" style="width: 50px" class="fanye"> 页
            </div>
        </div>

    </div>



</div>

<script src="../js/jquery-3.2.1.js"></script>
<script src="../dist/sidebar-menu.js"></script>
<script>
    $.sidebarMenu($('.sidebar-menu'))
</script>
<script>
    $(function(){
    	cxnj();
    	cxstk(1);
    	cxsybook();
    	cxtbj();
    	xsxjk(1);
    	cxjjksdks(3);
    	cxzzjxks(3);
    	//$("body").css("overflow","hidden");	
    	
    	$(".sjyls2").click(function(){
    		var sjid=$(".sjxxxx .fbsjmc").attr("sjid");
    		
    		$.getJSON("bcsjid/"+sjid,function(date){
  				location.href="sjyl";
  			})
    	})
    	
    	$(".xssyjjks").click(function(){
    		cxjjksdks(100);
    	})
    	
    	$("#shitk .sxstk").click(function(){
    		cxstk(1);
    	});
    	$(".fanye").change(function(){
    		var index=$(this).val();
    		cxstk(index);
    	})
    	$("#shijk .sxstk").click(function(){
    		xsxjk(1);
    	});
    	$(".fanye2").change(function(){
    		var index=$(this).val();
    		xsxjk(index);
    	})
    	$("#prePage").click(function(){
			var currentPage=$(this).attr("data-val");
			cxstk(currentPage);
		});
    	
		$("#nextPage").click(function(){
			var currentPage=$(this).attr("data-val");
			cxstk(currentPage);
		});
		
		$("#prePage2").click(function(){
			var currentPage=$(this).attr("data-val");
			xsxjk(currentPage);
		});
    	
		$("#nextPage2").click(function(){
			var currentPage=$(this).attr("data-val");
			xsxjk(currentPage);
		});
		$("#prePage3").click(function(){
			var currentPage=$(this).attr("data-val");
			cxsyks(currentPage);
		});
    	
		$("#nextPage3").click(function(){
			var currentPage=$(this).attr("data-val");
			cxsyks(currentPage);
		});
		
    	$(".tmlx .stfl").change(function(){
    		 var gId=$(this).val();    	
    		 xsctzsd(gId);
    		 $(".ctfw").show();
             $(".cyy").show();
    	});
    	
    	$(".tmlx input").click(function(){
   		 var gId=$(".tmlx .stfl").val();    	
   		    xsctzsd(gId);
   		    $(".ctfw").show();
            $(".cyy").show();
   		});
    	
    	//重置
    	$("#tjst .czst").click(function(){
    		$("#tjst textarea").val("");
    		$("input[name=y]").prop("checked",false);
    	});
    	
    	//选择知识点
    	$(".ctfw .xz").click(function(){   	
    		 $(".ctfw").hide();
             $(".cyy").hide();
    	});
    	
    	$(".tmlx .stlx").change(function(){
    		if($(this).val()=="2"){
    			$(".xuanx input").attr("type","checkbox");
    		}else{
    			$(".xuanx input").attr("type","radio");
    		}
    	})
    	
    
    	
    	$("#tjst .lrst").click(function(){
    		var c=1;//判断选项是否为空
    		var idDouble=$(".stlx").val();//1单选，2多选
    		var zsdid=$(".tmlx input").attr("zsdid");//获取知识点id
    		var zsdname=$(".tmlx input").val();//判断是否选择了知识点
    		var uid=$(".uid").html();//获取用户id
    		var zt=$(this).attr("zt");//判断是修改还是新增题目
    		var wt=$(".ctnr .tigan").val();//问题	
    		var jx=$(".jiexi").val();//解析
    		var a=$(".xuanxiang");//获取选项个数
    		var yn=$("[name=y]");
    		var z="";
    		var zs=2;//是否有正确选项
    		for(i=0;i<a.length;i++){
    			
    			z=$(yn[i]).prop("checked");   
    			if(z==true){
    				zs=1;
    			}
    			if(a.eq(i).val()==""){
    				c=2;
    			}
    		}
    		if(zt=="1"){
    			if(wt!=""&&c==1&&jx!=""&&zsdname!="选择知识点"&&zs!=2){
    				
    				var param="wt="+wt+"&jx="+jx+"&uid="+uid+"&idDouble="+idDouble+"&zsdid="+zsdid;    				
    				$.ajax({
    					type:"POST",
    					url:"xztm",
    					data:param,
    					success:function(res){
    						xzxx(res);
    					}
    				}); 
    			}else if(zsdname=="选择知识点"){
    				alert("请先选择题目的知识点");
    			}else if(zs==2){
    				alert("请选择正确答案");
    			}else{
    				alert("请将信息填写完整再录入");
    			}
    		}else if(zt=="2"){
    			var wtid=$(".ctnr .tigan").attr("tmid");//问题id	
    			var jxid=$(".jiexi").attr("jxid");//解析id
				if(wt!=""&&c==1&&jx!=""&&zs!=2){			
    				var param="wt="+wt+"&jx="+jx+"&idDouble="+idDouble+"&zsdid="+zsdid+"&wtid="+wtid+"&jxid="+jxid;    				
    				$.ajax({
    					type:"PUT",
    					url:"xgtm",
    					data:param,
    					success:function(res){
    						xgxx(wtid);
    					}
    				}); 
    			}else if(zs==2){
    				alert("请选择正确答案");
    			}else{
    				alert("请将信息填写完整再录入");
    			}
    			
    		} 
    	})
    	
    	 $(".ctfw .gb").click(function(){
           $(".cyy").hide();
            $(".ctfw").hide();
        });
    	
        $(".bjjyfbdsj .fh").click(function(){
            var zt=$(".bjjyfbdsj .fh").attr("zt");
            $("#shouye").hide();
            $("#tjst").hide();
            $("#shitk").hide();
            $("#bjsj").hide();
            if(zt==1){
                $("#shijk").show();
                $("#cjks").hide();
                $("#bjks").hide();
            }else if(zt=="2"){
                $("#cjks").show();
                $("#shijk").hide();
                $("#bjks").hide();
            }else if(zt=="3"){
                $("#bjks").show();
                $("#shijk").hide();
                $("#cjks").hide();
            }
        })
        
        $("[name=ck]").click(function () {
            if(this.checked==false){
                $(".cks").prop("checked",false);
                $(this).prop("checked",true);
                $(this).parents("tr").addClass("bgbk2");
            }else{
                $(this).prop("checked",false);
                $(this).parents("tr").removeClass("bgbk2");
            }
        })
        
       
        
        $(".ksxxxx .ksbj").change(function(){
        	  var a=$(this).find("option:selected").text();
        	  var a2=$(this).val();
        	  var bj=$(".ksxxxx .ksfl input").val();
        	  var bj2=$(".ksxxxx .ksfl input").attr("bjid");
        	  
        	  if(a!="选择班级"){
	        	  if(bj==""){
	        		  $(".ksxxxx .ksfl input").val(a);
	        		  $(".ksxxxx .ksfl input").attr("bjid",a2);
	        	  }else if(bj.indexOf(a)!=-1){
	        		  
	        	  }else{
	        		  $(".ksxxxx .ksfl input").val(bj+","+a);
	        		  $(".ksxxxx .ksfl input").attr("bjid",bj2+","+a2);
	        	  }
        	  }
        })
        
       
        
        $(".stfw .gb,.stfw .xz").click(function(){
           $(".stfw").hide();
            $(".cyy").hide();
        })
        
      
       
        $(".fabu .sjyl").click(function(){
        	location.href="sjyl"
        })
    
        
        $(".div2 .xyb").click(function(){
        	var a=$(".zsdtm");
        	var v=0;//判断信息是否填写完整
        	var mbmc=$(".mbmc input").val();//模板名称
        	var time=$(".cssc input").val();//考试时常
        	var mtfs=$(".mtfs input").val();//每题分数
        	var ksfw=$(".ksfw input").val();//考试范围
        	for(var i=0;i<a.length;i++){
        		if($(a[i]).find("sb").val==0||$(a[i]).find("zj").val==0||$(a[i]).find("zsd").val==0||$(a[i]).find("input[type=text]").val()==""){
        			v=1;
        			break;
        		}
        	}
        	
			if(v==1){
        		alert("请先将试题信息填写完整");
        		v=0;
        	}else if(mbmc==""||time==""||mtfs==""){
        		alert("请先将模板信息填写完整");
        	}else if(v==0){
        		var param={'epName':mbmc,'score':mtfs,'testRange':ksfw,'teaId':$(".uid").html(),'gId':$(".ssnj select").val(),'testTime':time};
           	 $.ajax({
    				type:"POST",
    				url:"xzksmb",
    				dataType:"json",
    			    contentType:"application/json",
    				data:JSON.stringify(param),
    				success:function(res){					
    					xzsj(res);
    					xzmbgx(res);
    				}
    			}); 
	        	
        	}
           
        });
        
       
        
        $(".yymb i").click(function(){
            var a=$(this).attr("class");
            var b=$(".xmb i").attr("class");
            if(a=="fa fa-circle-o"&&b=="fa fa-check-circle"){
                $(this).attr("class","fa fa-check-circle");
                $(".xmb i").attr("class","fa fa-circle-o");
                $(".cjmbnr").hide();
                $(".div3").slideDown();
            }
        });
        
        $(".xmb i").click(function(){
            var a=$(this).attr("class");
            var b=$(".yymb i").attr("class");
            if(a=="fa fa-circle-o"&&b=="fa fa-check-circle"){
                $(this).attr("class","fa fa-check-circle");
                $(".yymb i").attr("class","fa fa-circle-o");
                $(".cjmbnr").slideDown();
                $(".div3").hide();

            }
        })
        
        $(".ssnj select").change(function(){
           var a= $(this).val();
            if(a!="0"){
                $(".ksfw input").val("选择范围");
                cxbooks(a);
            }else{
                $(".ksfw input").val("全年级");
                cxsybook();
                $(".zsdtm .zj").val(0);
                $(".zsdtm .zsd").val(0);
            }
            $(".zsdtm select").attr("disabled",false);
        })


        $(".cjxsjxyb").click(function(){
        	var sjmc=$(".cjxsj .sjmc").val();
        	if(sjmc==""){
        		alert("请先填写试卷名称");
        	}else{
	            $(".div1").css("display","none");
	            $(".xtzj").css("display","block");
	            $(".fbks").css("display","none");
	            $(".cjksbz a").css("color","#999999");
	            $(".cjksbz .drb").css("color","blue");
	            cxksmb();
        	}
        });
        
        $(".xzyysjxyb").click(function(){
        	var a=$(".xzsjcj input").val();

        	if(a!="选择试卷"){
	        	var sjid=$(".xzyysj .xzsjcj input").attr("sjid");
	        	cxsjxx(sjid);
        	}else{
        		alert("请先选择试卷");
        	}
           
        })
    })

    function fbks(th){
    	var fw=$("#cjks .ksfl input").attr("bjid");
    	var sj=$("#cjks .kssj").val();
    	var sj2=sj.replace(/T/," ");
    	var js=$("#cjks .jssj").val();
    	var js2=js.replace(/T/," ");
    	var wbk=$("#cjks .kssm").val();
    	var sjid=$(".fbsjmc").attr("sjid");
    	if(sj!=""&&js!=""&&fw!=""&&wbk!=""){
	    	 var param={'examPaperId':sjid,'classId':fw,'teaId':$(".fbcjr").attr("tid"),'startTime':sj2,'endTime':js2};
		  	  $.ajax({
				type:"POST",
				url:"xzks",
				dataType:"json",
			    contentType:"application/json",
				data:JSON.stringify(param),
				success:function(res){					
					
					xzksryxx(sjid,sj2,js2,fw);
					$("#cjks .kssm").val("");
					$("#cjks .ksxxxx input").val("");
					$("#cjks .ksbj").val(0);
					$("#cjks .kssj").val("");
					$("#cjks .jssj").val("");
					chuangjiankaoshi();
					
				}
			}); 
    	}else{
    		alert("请先将考试信息填写完整");
    	}
    }
    
    function xzksryxx(sjid,kssj,jssj,xsid){
    	 alert(sjid+","+kssj+","+jssj+","+xsid);
    	 $.getJSON("xzksryxx?xsid="+xsid+"&sjid="+sjid+"&kssj="+kssj+"&jssj="+jssj,function(date){
    		alert("发布成功");
    	}) 
    }
    function sbchange(th){
    		var bookId=$(th).val();
    		$(th).next().html("<option value=\"0\">选择课程</option>");    		
    		$.getJSON("cxCourse/"+bookId,function(date){
      			$.each(date,function(){    				
      				$(th).next().append("<option value=\"" +this.courseId+ "\">"
                            + this.courseName+ "</option>")
      			});
      			
      		 });
    	}
    
    function zjchange(th){
    	var courseId=$(th).val();
		$(th).next().html("<option value=\"0\">选择章节</option>");
		
 		 $.getJSON("cxKnowledge/"+courseId,function(date){
   			$.each(date,function(){
   				$(th).next().append("<option value=\"" +this.knowId+ "\">"
                         + this.knowName + "</option>")
   			});
   		 });
    }
    
    //选择试题范围
    function xzstfw(th,zt){
        var nr=$(th).val();
        $(".stfw .shuml").html("");
        var gId=$(".ssnj select").val();
        if(nr!="全年级"||nr==""){
        	 $.getJSON("cxBook/"+gId,function(date){
    			 $.each(date,function(i,objb){
    				 var li=$("<li>"+
 				            "<i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label bookId=\""+this.bookId+"\" onclick=\"fwkc('"+this.bookId+"','"+this.bookName+"')\">📚 "+this.bookName+"</label>"+
				             "<ul class=\"zjml\"></ul></li>");
    				 $(".stfw .shuml").append(li);
    				 
    				  $.each(this.listc,function(is,obj){
    					  var li2=$("<li>"+
    		                    "<i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label courseId='"+obj.courseId+"' onclick=\"fwzj('"+objb.bookId+"','"+objb.bookName+"','"+obj.courseId+"','"+obj.courseName+"')\">📃"+obj.courseName+"</label>"+
    		                    "<ul class=\"zsdml\"></ul></li>")
    						li.find(" .zjml").append(li2);
    		                    
		                $.each(obj.listk,function(ik,objk){
		                    	   li2.find(".zsdml").append( " <li>"+
		                           " <label knowId='"+objk.knowId+"' onclick=\"fwzsd('"+objb.bookId+"','"+objb.bookName+"','"+obj.courseId+"','"+obj.courseName+"','"+objk.knowId+"','"+objk.knowName+"')\">📑  "+objk.knowName+"</label></li>");
		                       });
    				 }) ;
    			 });
    			 
    			 $(".stfw .shuml li label").click(function(){
    	                $(".stfw .shuml li label").css("border-color","#7c7c7cbd");
    	                $(".stfw .shuml li label").css("background-color","white");
    	                $(this).css("background-color","#f4d2ca");
    	                $(this).css("border-color","#ff5600");
    	            });
    		 });
            $(".stfw").show();
            $(".cyy").show();
            
        }
    }
    //显示所有试卷
    function xsxjk(pageIndex){
    	var pageSize=8;
    	$(".sjdiv .sjbsj").html("");
    		
    	$.getJSON("cxsysj/"+pageIndex+"/"+pageSize,function(date){
    		$("#prePage2").attr("data-val",date.prePage);
    		$("#currentPage2").html(date.pageNum+"/"+date.pages);
    		$("#nextPage2").attr("data-val",date.nextPage);
    		
    		$.each(date.list,function(){
    			$(".sjdiv .sjbsj").append("<tr>"
                      +"<td style=\"width: 80px;height: 40px;text-align: center\">"
                      +"<input type=\"checkbox\" name=\"ck\" sjid='"+this.paperId+"'></td>"
                      +"<td  style=\"width: 150px\">"+this.paperName+"</td>"
                      +"<td style=\"width: 150px\">"+this.tmsum+"</td>"
                      +"<td style=\"width: 150px\">"+this.score+"</td>"
                      +"<td style=\"width: 150px\">"+this.teaName+"</td>"
                      +"<td style=\"width: 230px\">"+this.lastUpdTime+"</td>"
                      +"<td style=\"width: 150px\">"+this.useCount+"</td>"
                      +"<td style=\"width: 90px\">"
                      +"<a title=\"编辑\" onclick=\"bjsj(this,'"+this.paperId+"','"+this.paperName+"')\" zt=\"1\">"
                      +"<i class=\"fa fa-pencil\"></i></a>&nbsp;"
                      +"<a title=\"删除\"><i class=\"fa fa-trash-o\"></i></a>"
                      +"</td></tr>"
                      +"<tr style=\"height:5px;\"></tr>");
    		})
    		
    		 $("#shijk .sjbsj tr").mousemove(function(){
    	            $(this).addClass("bgbk");
    	        });
    	        
    	        $("#shijk .sjbsj tr").mouseout(function(){
    	            $(this).removeClass("bgbk");
    	        });
    	        
    	        $("#shijk .sjbsj tr").click(function(){
    	            var a=$(this).find("input[type=checkbox]").prop("checked");
    	            if(a==true){
    	                $(".cks").prop("checked",false);
    	                $(this).find("input[type=checkbox]").prop("checked",false);
    	                $(this).removeClass("bgbk2");
    	            }else{
    	                $(this).find("input[type=checkbox]").prop("checked",true);
    	                $(this).addClass("bgbk2");
    	            }
    	        });
    	})
    }
    //新增试卷
    function xzsj(epId){
    	var param={'epId':epId,'paperName':$(".cjxsj .sjmc").val(),'createPerson':$(".uid").html(),'lastUpdPerson':$(".uid").html()};
	  	 $.ajax({
			type:"POST",
			url:"xzsj",
			dataType:"json",
		    contentType:"application/json",
			data:JSON.stringify(param),
			success:function(res){					
				xzsjtm(res);
			}
		}); 
    }
    
    //新增模板关系
    function xzmbgx(epId){
    	var a=$(".zsdtm .zsd");
    	var param=[];
    	for(var i=0;i<a.length;i++){
    		var zsdid=$(a[i]).val();
    		var sum=$(a[i]).next().find("input").val();
    		var dx={'epId':epId,'knowId':zsdid,'count':sum};
    		param.push(dx);
    	}
    	$.ajax({
				type:"POST",
				url:"xzmbgx",
				dataType:"json",
			    contentType:"application/json",
				data:JSON.stringify(param),
				success:function(res){					
					
				}
    	});
    }
    
    //新增试卷题目
    function xzsjtm(examId){
    	var a=$(".zsdtm .zsd");
    	var param=[];
    	for(var i=0;i<a.length;i++){
    		var zsdid=$(a[i]).val();
    		var sum=$(a[i]).next().find("input").val();
    		$.ajaxSettings.async = false;
    		$.getJSON("cxsjtm/"+zsdid+"/"+sum,function(date){
    			$.each(date,function(){
    				var dx={'qtId':this.qtId,'examId':examId};
    				param.push(dx);
    			});
    			
    		})
    	}    	
    	console.info(JSON.stringify(param));
		  $.ajax({
			type:"POST",
			url:"xzsjtm",
			dataType:"json",
		    contentType:"application/json",
			data:JSON.stringify(param),
			success:function(res){	
				cxsjxx(examId);
				
			}
		}); 
    }
    
    //根据试卷id查询新增的试卷信息
    function cxsjxx(sjid){
    	$.getJSON("cxygsj/"+sjid,function(date){
    		$(".fbsjmc").attr("mbid",date.epId);
    		$(".fbsjmc").attr("sjid",date.paperId);
    		$(".fbsjmc").html(date.paperName);
    		$(".fbsjzf").html(date.score);
    		$(".fbcjr").html(date.teaName);
    		$(".fbcjr").attr("tid",date.createPerson);
    		$(".fbstsl").html(date.tmsum);
    		$(".fbcjsj").html(date.createTime);
    		
    		$(".div1").css("display","none");
            $(".xtzj").css("display","none");
            $(".fbks").css("display","flex");
            $(".cjksbz a").css("color","#999999");
            $(".cjksbz .dsb").css("color","blue");
            
        	$(".mbmc input").val("");//模板名称
        	$(".cssc input").val("");//考试时常
        	$(".ssnj select").val(0);
        	$(".mtfs input").val("全年级");//每题分数
        	$(".ksfw input").val("");//考试范围
        	$(".cjxsj .sjmc").val("");
        	$(".zsdtm .sb").val(0);
        	$(".zsdtm .zj").val(0);
        	$(".zsdtm .zsd").val(0);
    	});
    }
    function gbxgkssj(th){
        $(".xzkssj").hide();
        $(".cyy").hide();
    }
    
    function ghjyksdsj(th){
    	var pageIndex=1;
    	var pageSize=100;
    	
    	var zt=$(th).val();
    	if(zt=="更换试卷"){
 			$(".xzkssj").attr("zt","2");
    	}
    	
    	
    	$(".xzkssj .sjtb").html(" <tr> "
                +"<td  style=\"width: 50px;height: 50px\"></td>"
                +"<td  style=\"width: 200px;\">名称</td>"
                +"<td style=\"width: 150px\">总分</td>"
                +"<td style=\"width: 170px\">创建人</td>"
                +"<td style=\"width: 190px\">创建时间</td>"
                +"</tr>");
    	
    	$.getJSON("cxsysj/"+pageIndex+"/"+pageSize,function(date){
    		$.each(date.list,function(){
    			$(".xzkssj .sjtb").append(" <tr sjid='"+this.paperId+"'><td style=\"text-align: center\">"
    					+"<input type=\"checkbox\"></td>"
    					+"<td class='mc'>"+this.paperName+"</td>"
    					+"<td>"+this.tmsum+"</td>"
    					+"<td>"+this.teaName+"</td>"
    					+"<td>"+this.lastUpdTime+"</td>"
    					+"</tr>");
    		})
    		
    		 $(".xzkssj  .sjtb tr:gt(0)").mouseout(function () {
            $(this).css("background-color","white");
        })
        
        $(".xzkssj  .sjtb tr:gt(0)").mousemove(function () {
            $(this).css("background-color","#aebbd26b")
        })
        
        $(".xzkssj  .sjtb tr:gt(0)").click(function () {
            $(".xzkssj .sjtb tr").find("input").prop("checked",false);
            $(".xzkssj .sjtb tr").css("border","0px solid #0088DB");
            $(this).css("border","1px solid #0088DB");
            $(this).find("input").prop("checked",true);
            
            var sjid=$(this).attr("sjid");
            var sjmc=$(this).find(".mc").html();
            
            $(".xzsjcj input").val(sjmc);
            $(".xzsjcj input").attr("sjid",sjid);
            
            var zt=$(".xzkssj").attr("zt");
            if(zt=="2"){
            	cxsjxx(sjid);
            }
        })
        
        $(".xzkssj  .sjtb tr input[type=checkbox]").click(function () {
            $(this).prop("checked",false);
            $(".xzkssj .sjtb tr").css("border","0px solid #0088DB");
            $(".xzkssj .sjtb tr").css("border","1px solid #0088DB");
            $(this).prop("checked",true);
            
            var sjid=$(this).parents("tr").attr("sjid");
            var sjmc=$(this).parents("tr").find(".sjmc").html();
            
            $(".xzsjcj input").val(sjmc);
            $(".xzsjcj input").attr("sjid",sjid);
            
           
        })
        
    	})
    	
        $(".xzkssj").show();
        $(".cyy").show();
    }

    function scst(th){
        $(th).parents(".zsdtm").remove();
    }
    
    //计算时间
    function jsjssj(th){
    	var mbid=$(".fbsjmc").attr("mbid");
    	var sj=$(th).val();
    	var yongshi=0;
    	
    	$.getJSON("cxdgmb/"+mbid,function(date){
    		yongshi=date.testTime;
    	}); 
    	var time = yongshi*60*1000;//分钟
    	
    	var ew=parseInt(yongshi/60);

    	var hours=parseFloat(sj.substring(11,13));
    	
		var miuth=parseFloat(sj.substring(14,16));
		
    	if(ew==0){
    		
    	miuth=miuth+yongshi;
    	
    	if(miuth>=60)
    	{   		
    		miuth=miuth+(miuth%60);
    		hours=hours+parseInt(miuth/60);
    	}
    	}else{
    		//var hour=parseInt(yongshi/60);
    		hours=hours+ew;
    		miuth=miuth+(yongshi%60);
    	}    	
	    var time1=sj.replace(sj.substring(11,13),hours);	   
    	var time2=time1.replace(time1.substring(14,16),miuth);
        $(th).next().val(time2);
    	
    }
  	//查询老师带的班级
    function cxtbj(){
    	var uid=$(".uid").html();
    	$(".ksxxxx .ksbj").html("<option value='0'>选择班级</option>");
    	$.getJSON("cxtbj/"+uid,function(date){
    		$.each(date,function(){
    			$(".ksxxxx .ksbj").append("<option value='"+this.classId+"'>"+this.cName+"</option>");
    		})
    	})
    }
    function zsst(th){
        $(".timu").append("<div class=\"zsdtm\">"
        +"书本：<select class=\"sb\" onclick=\"sbchange(this)\">"
                +"<option value='0'>选择课程</option>"
                +"</select> &nbsp;"
                +"章节：<select class=\"zj\" onclick=\"zjchange(this)\">"
                +"<option value='0'>选择课程</option>"
                +"</select> &nbsp;"
                +"知识点：<select class=\"zsd\">"
                +"<option value='0'>选择章节</option>"
                +"</select>"
                +"<div style=\"margin-top: 5px\">"
                +"题数：<input type=\"text\" style=\"width: 100px;padding-left: 10px\">"
        +"</div>"
        +"<div style=\"margin-left: 520px;margin-top: -20px;\">"
        +"<i class=\"fa fa-close\" onclick=\"scst(this)\"></i>"
        +"</div>"
        +"</div>");
        var fw=$(".ssnj select").val();//年级id
        var kcid=$(".ksfw input").attr("kcid");//课程id
        var zjid=$(".ksfw input").attr("zjid");//章节id
        var zsdid=$(".ksfw input").attr("zsdid");//知识点id
        alert(kcid+","+zjid+","+zsdid)
        if(fw=='0'){
        	cxsybook();
        }else{
        	if(kcid!='0'){       		
        		cxbooks(fw);
        		$(".zsdtm .sb").val(kcid);
        		
        	}else{
        		cxbooks(fw);
        	}
        	
        	if(zjid!='0'){
        		cxzj(kcid);
        		$(".zsdtm .zj").val(zjid);
        	}else{
        		if(kcid!=0){
        			//cxzj(kcid);
        			var bookId=kcid;
        			$.getJSON("cxCourse/"+bookId,function(date){
        	   			$.each(date,function(){
        	   				$(".timu").children(".zsdtm:last-child").find(".zj").append("<option value=\"" +this.courseId+ "\">"
        	                         + this.courseName+ "</option>")
        	   			});
        	   		 });
        		}
        	}
        	
        	if(zsdid!='0'){
        		cxzsd(zjid);
        		$(".zsdtm .zsd").val(zsdid);
        	}else{
        		if(zjid!=0){
        			//cxzsd(zjid);
        			var courseId=zjid;
        			$.getJSON("cxKnowledge/"+courseId,function(date){
            			$.each(date,function(){
            				$(".timu").children(".zsdtm:last-child").find(".zj").append("<option value=\"" +this.knowId+ "\">"
                                  + this.knowName + "</option>")
            			});
            		 });
        		}
        	}
        }
 
    }
    
    function sjxs(th){
        $(th).css("margin-top","0px");
        $(th).css("-webkit-box-shadow","3px 10px 20px #cfcfcf");
        $(th).css("margin-bottom","10px");
    }
    
    function sjxx(th){
        $(th).css("margin-top","10px");
        $(th).css("-webkit-box-shadow","0 0");
        $(th).css("margin-bottom","0");
    }
    
    function bjsj(th,sjid,sjmc){
    	if(sjid!="0"){
    		
    	}else{
    		
    		sjmc=$(".sjxxxx .fbsjmc").html();
    		sjid=$(".sjxxxx .fbsjmc").attr("sjid");
    		
    	}
    	var a=$(th).attr("zt");
        $(".bjjyfbdsj .fh").attr("zt",a);
        $(".bjjyfbdsj .sjmc").html(sjmc);
        
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjsj").show();
        $("#bjks").hide();
        cxsjtmzsd(sjid);
    }
    
  	//查询试卷题目的知识点和每个知识点题目的数量
    function cxsjtmzsd(sjid){
    	$("#zsdlb").html("");

    	$.ajaxSettings.async = false;
    	$.getJSON("cxsjtmzsd/"+sjid,function(date){
    		$.each(date,function(){
    			$("#zsdlb").append(" <div class=\"zsdzl\" zsdid='"+this.knowId+"'>"
                       +"<p style='font-size: 17px;margin-bottom: 15px;'>"+this.knowName+"</p>"
                       +"<p style='margin-bottom: 15px;margin-left: 20px'> 共 &nbsp;"
                       +" <input type='text' style=\"width: 30px;height: 20px\" value='"+this.tmsum+"'>" 
                       +" &nbsp;题 ，每题 &nbsp;<label>"+this.score+"</label> &nbsp; 分</p>"
                       +" <p><a onclick=\"ghsjtm('"+this.knowId+"','"+sjid+"')\">换题</a><a onclick=\"ghzsd('"+this.knowId+"','"+sjid+"')\">换知识点</a></p>"
                       +"</div>");
    		})
    	})
    	
    	var a=$("#zsdlb .zsdzl");
    	var sum=0;
    	var tm=0;
    	for(var i=0;i<a.length;i++){
    		
    		var tmsl=$(a[i]).find("input").val();

    		tm=parseInt(tm)+parseInt(tmsl);
    		
    		sum=$(a[i]).find("label").html();
    	}
    	
    	sum=tm*parseInt(sum);
    	$(".zongji .t").html(tm);
    	$(".zongji .f").html(sum);
    	$(".bjjyfbdsj .sjmc").attr("sjid",sjid);
    	
    	cxsjtm(sjid);
    }
  	
  	//跟换试卷题目
  	function ghsjtm(zsdid,sjid){
  		var sum=0;
  		var a=$("#zsdlb .zsdzl");
  		for(var i=0;i<a.length;i++){
  			if($(a[i]).attr("zsdid")==zsdid){
  				sum=$(a[i]).find("input").val();
  				break;
  			}
  		}
  		$.getJSON("ghsjzsdtm/"+zsdid+"/"+sjid+"/"+sum,function(date){
  			
  				cxsjtmzsd(sjid);
  				alert("更换成功");  			
  		})
  	}
  	
  	//查询试卷题目及答案解析
  	function cxsjtm(sjid){
  		var zsd=$("#zsdlb .zsdzl");
  		$(".bjjyfbdsj .tmmk").html("");
  		
  		$.getJSON("cxsjtm/"+sjid,function(date){
  			for(var iv=0;iv<zsd.length;iv++){
  				
  				var mc=$(zsd[iv]).find("p:eq(0)").html();
  				var zsdid=$(zsd[iv]).attr("zsdid");
  				var div=$(" <div class=\"zsdsytm\">"
  			            +"<p class=\"zsd\">"+mc+"</p>"
  			            +"<div class=\"tm\"></div></div>");
  				$(".bjjyfbdsj .tmmk").append(div); 
  				
  				$.each(date,function(){ 	
  					
  					var pd=this.idDouble;
  					
  					if(this.knowId==zsdid){
	  	    			 var div2=$("<div>"
	  	    					+"<p style=\"margin-left: 0\">"+this.qtQuest+"</p>"
	  	    					+"<div class='xz'></div>"
	  	    					+"<p style=\"color: #656262c9\">解析："+this.jiexi+"</p></div>");
	  	    			  div.append(div2);
	  	    			  
	  	    			 $.each(this.list,function(i,obj){
	  	    				 
	  	    				var idDoubles="";

	  	  					if(pd==1){
	  	  						if(obj.isRight==1){
	  	  							idDoubles="fa fa-dot-circle-o";
	  	  						}else{
	  	  							idDoubles="fa fa-circle-o";
	  	  						}
	  	  					}else{
	  	  						if(obj.isRight==1){
	  	  							idDoubles="fa fa-check-square-o";
	  	  						}else{
	  	  							idDoubles="fa fa-square-o";
	  	  						}
	  	  					}
	  	    				 div2.find(".xz").append("<p><i class=\""+idDoubles+"\"></i>&nbsp;&nbsp;"+obj.opORder+"."+obj.rightOption+"</p>");
	  	    			 })
  					}
  	    		})
  			}
    		
  		})
  	}
    function bjks(th){
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjsj").hide();
        $("#bjks").show();
        $("#ksgl").hide();
        
        var zt=$(th).attr("zt");
        var sjid=$(th).parents(".zzjxsj").find(".sysjmc").attr("sjid");
        var ksid=$(th).parents(".zzjxsj").find(".sysjmc").attr("ksid");
        var fbr=$(th).parents(".zzjxsj").find(".sysjmc").attr("fbr");
        var uid=$(".uid").html();
        if(zt=="2"){
        	if(fbr==uid){
        		
	        	$.getJSON("cxycks/"+ksid,function(date){
	        		
	        		cxsjxx(sjid);
	        		hqbjmc(date.classId);
	        		var ks=date.startTime;
	        			ks=ks.replace(/ /,"T");
	        			
	        		var js=date.endTime;
	        			js=js.replace(/ /,"T");
	        			
	        	    $("#bjks .kssj").val(ks);
		        	$("#bjks .jssj").val(js);
		        	$("#bjks .fbsjmc").attr("ksid",ksid);
	        	})
	        	
        	}else{
        		alert("只能编辑自己发布的试卷！");
        	}
        }
    }
    
    //获取有编辑的考试的班级名称
    function hqbjmc(bjid){
    	
    	var uid=$(".uid").html();
    	var arr=new Array();
		arr=bjid.split(",");
		var bjmc="";
		
		$.ajaxSettings.async = false;
    	$.getJSON("cxtbj/"+uid,function(date){
    		$.each(date,function(i,obj){
    			if(arr[i]==obj.classId){
    				
    				bjmc+=obj.cName+",";
    			}

    		})
    	})
    	
    	bjmc = bjmc.slice(0,bjmc.length-1);
    	$("#bjks .ksfl input").val(bjmc);
    }
    
    function shijuaku(th){
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").show();
        $("#bjsj").hide();
        $("#bjks").hide();
        $("#ksgl").hide();
        xsxjk(1);
    }
    
    function shitiku(th){
        $("#bjsj").hide();
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").show();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjks").hide();
        $("#ksgl").hide();
        cxstk(1);
    }
    
    function tianjiashiti(th,zt){
        $("#bjsj").hide();
        $("#shouye").hide();
        $("#tjst").show();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjks").hide();
        $("#ksgl").hide();
        $("#tjst .lrst").attr("zt",zt)
    }
    
    function shouye(th){
        $("#bjsj").hide();
        $("#shouye").show();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjks").hide();
        $("#ksgl").hide();
    }
    
    function chuangjiankaoshi(th){
        $("#bjsj").hide();
        $("#cjks").show();
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#shijk").hide();
        $("#bjks").hide();
        $("#ksgl").hide();
        $(".div1").css("display","flex");
        $(".xtzj").css("display","none");
        $(".fbks").css("display","none");
        $(".cjksbz a").css("color","#999999")
        $(".cjksbz .dyb").css("color","blue")
    }
    
    function kaoshiguanli(th){
    	$("#bjsj").hide();
        $("#shouye").hide();
        $("#tjst").hide();
        $("#shitk").hide();
        $("#cjks").hide();
        $("#shijk").hide();
        $("#bjks").hide();
        $("#ksgl").show();
        cxsyks(1);
    }
    
    function cxsyks(pageIndex){
    	
    	$("#ksgl .stbt:eq(1)").html("");
    	
    	$.getJSON("cxsyks/"+pageIndex,function(date){
    		
    		$("#prePage3").attr("data-val",date.prePage);
    		$("#currentPage3").html(date.pageNum+"/"+date.pages);
    		$("#nextPage3").attr("data-val",date.nextPage);
    		
    		$.each(date.list,function(){
    			$("#ksgl .stbt:eq(1)").append("<tr>"
                       +"<td style=\"width: 58px;height: 40px;text-align: center\">"
                       +"<input type=\"checkbox\" name=\"ck\"></td>"
                       +"<td style='width: 150px'>"+this.paperName+"</td>"
                       +"<td style='width: 120px'>"+this.zscore+"</td>"
                       +" <td style='width: 150px'>"+this.tmsum+"</td>"
                       +"<td style='width: 150px'>"+this.teaName+"</td>"
                       +"<td style='width: 200px'>"+this.startTime+"</td>"
                       +"<td style='width: 200px'>"+this.endTime+"</td>"
                       +"<td style='width: 150px'><a title=\"查看详情\" >"
                       +"<i class=\"fa fa-newspaper-o\"></i></a>"
                       +"</td></tr>");
    		});
    		
    		 $("#ksgl .stbt:eq(1) tr").mousemove(function(){
	             $(this).addClass("bgbk");
	         });
	         
	         $("#ksgl .stbt:eq(1) tr").mouseout(function(){
	             $(this).removeClass("bgbk");
	         });
	         
	         $("#ksgl .stbt:eq(1) tr").click(function(){
	             var a=$(this).find("input[type=checkbox]").prop("checked");
	             if(a==true){
	                 $(".cks").prop("checked",false);
	                 $(this).find("input[type=checkbox]").prop("checked",false);
	                 $(this).removeClass("bgbk2");
	             }else{
	                 $(this).find("input[type=checkbox]").prop("checked",true);
	                 $(this).addClass("bgbk2");
	             }
	         });
    	})
    }
    
    //全选
    function ckAll(th){
        var cks=document.getElementsByName("ck");
        for(var i=0;i<cks.length;i++){
            cks[i].checked=th.checked;
        }
        if(th.checked==true){
            $(".sjbsj tr").addClass("bgbk2");
            $(".stbt tr:gt(0)").addClass("bgbk2");
        }else{
            $(".sjbsj tr").removeClass("bgbk2");
            $(".stbt tr:gt(0)").removeClass("bgbk2");
        }
    }
    function tjygxx(th){
    	var lx=$(".stlx").val();
    	var ty="radio";
    	if(lx=="2"){
    		ty="checkbox";
    	}
        $(".mrxx").append("<div class=\"xuanx\">"
        +"<div><input type=\""+ty+"\" name=\"y\"></div>"
                +"<textarea class=\"xuanxiang\" onfocus=\"srxx(this)\" onblur=\"xxwc(this)\"></textarea>"
        +" <div class=\"qxxx\" onclick=\"scxx(this)\">x</div> </div>");
    }
    
    function scxx(th){
        $(th).parent().remove();
        var zt=$(".lrst").attr("zt");
        if(zt=="2"){
        	var xxid=$(th).prev().attr("xxid");
				 $.ajax({
						type:"delete",
						url:"scxx/"+xxid,
						contentType:"application/json",
						success:function(data){
						},
						error:function(xhr){
							alert(xhr.responseText);
						}
				});
        }
        
    }
    
    function srtg(th){
        $(th).css("height","150px");
    }
    
    function tgwc(th){
        $(th).css("height","60px");
    }
    
    function srxx(th){
        $(th).css("height","150px");
    }
    
    function xxwc(th){
        $(th).css("height","36px");
    }
    
    function srjx(th){
        $(th).css("height","150px");
    }
    
    function jxwc(th){
        $(th).css("height","100px");
    }
    
   function xsyd(th){
       $(th).css("margin-top","5px");
    }
   
    function xxyd(th){
        $(th).css("margin-top","15px");
        $(th).css("height","99px");
    }
    
    //查询所有年级
   function cxnj(){
	   $(".tmlx .stfl").html("");
	    $.getJSON("cxgrade",function(date){
	    	$.each(date,function(){
 				$(".tmlx .stfl").append("<option value=\""+this.gId+"\">"+this.gName+"</option>");
 			})
 		  })
   }
    function dj(th){
    	  var d=$(th).attr("class");
          if(d=="fa fa-plus-square-o"){
              $(th).attr("class","fa fa-minus-square-o");
              $(th).next().next().show();
          }else{
              $(th).attr("class","fa fa-plus-square-o");
              $(th).next().next().hide();
          }
    }
    //选中添加试题属于哪个知识点
    function xzzsd(th,zsd,zsdid){
    	 $(".ctfw li label").css("border-color","#7c7c7cbd");
    	 $(".ctfw li label").css("background-color","white");
         $(th).css("background-color","#f4d2ca");
         $(th).css("border-color","#ff5600");
         $(".tmlx input").val(zsd);
         $(".tmlx input").attr("zsdid",zsdid);
    }
    //修改选项
    function xgxx(id){
    	var a=$(".xuanxiang");//获取选项内容
    	var yn=$("[name=y]");
    	var xx=[];//选项
    	var param=[];
    	var isRight=0;//是否是正确答案
    	var xbs="ABCDEFGHIJKLMNOPQRSTUVWHYZ";
    	var z="";
		for(i=0;i<a.length;i++){			
			z=$(yn[i]).prop("checked");
			  if(z==true){
				 isRight=1;
			 }else{
				 isRight=2;
			 } 	
			  var opId=a.eq(i).attr("xxid");
			  if(opId==undefined){
				  var da={'opORder':xbs[i],'rightOption':a.eq(i).val(),'isRight':isRight,'qtId':id};
					  param.push(da);
				  $.ajax({
						type:"POST",
						url:"xztmxx",
						dataType:"json",
					    contentType:"application/json",
						data:JSON.stringify(param),
						success:function(res){					
							
						}
					}); 
			  }else{
				  var xb=xbs[i];
				  var nr=a.eq(i).val();
				  $.ajax({
						type:"put",
						url:"xgxx/"+xb+"/"+nr+"/"+isRight+"/"+opId,
						dataType:"json",
					    contentType:"application/json",
						success:function(res){					
							
						}
					}); 
			  }
			 
			  if(i==a.length-1){
				    alert("修改成功！");
					$("#tjst textarea").val("");
		    		$("input[name=y]").prop("checked",false);
			  }
			 // var da={'opORder':xb[i],'rightOption':a.eq(i).val(),'isRight':isRight,'opId':opId};
			//param.push(da);			 
		}
		  //console.info(JSON.stringify(param));
			
    }
    //新增选项
    function xzxx(id){
    	var a=$(".xuanxiang");
    	var yn=$("[name=y]");
    	var xx=[];//选项
    	var param=[];
    	var isRight=0;//是否是正确答案
    	var xb="ABCDEFGHIJKLMNOPQRSTUVWHYZ";
    	var z="";
		for(i=0;i<a.length;i++){			
			z=$(yn[i]).prop("checked");
			  if(z==true){
				 isRight=1;
			 }else{
				 isRight=2;
			 } 			 
			  var da={'qtId':id,'opORder':xb[i],'rightOption':a.eq(i).val(),'isRight':isRight};
			  param.push(da);			 
		}
		 //console.info(JSON.stringify(param));
			 $.ajax({
				type:"POST",
				url:"xztmxx",
				dataType:"json",
			    contentType:"application/json",
				data:JSON.stringify(param),
				success:function(res){					
						alert("发表成功！");
						$("#tjst textarea").val("");
			    		$("input[name=y]").prop("checked",false);
				}
			}); 
    }
    //查询试题库
    function cxstk(pageIndex){
    	$(".xssyst .stbt").html("");
    	$.getJSON("cxtk/"+pageIndex,function(date){
    		$("#prePage").attr("data-val",date.prePage);
			$("#currentPage").html(date.pageNum+"/"+date.pages);
			$("#nextPage").attr("data-val",date.nextPage);
    		
	    	$.each(date.list,function(i,obj){	
	    		var yn="单选"
		    	if(this.idDouble==2){
		    		yn="多选"
		    	}
		    	
		    	$(".xssyst .stbt").append("<tr>"+
		                        "<td style=\"width: 60px;height: 40px;text-align: center\"><input type=\"checkbox\" name=\"ck\" style=\"width: 20px;height: 20px;\"></td>"+
		                        "<td  style=\"width: 100px\">"+yn+"</td>"+
		                        "<td style=\"width: 200px\">"+obj.zsd+"</td>"+
		                        "<td style=\"width: 350px\"><div class='stnr' title='"+obj.qtQuest+"'>"+obj.qtQuest+"</div></td>"+
		                        "<td style=\"width: 150px\">"+obj.fbr+"</td>"+
		                        "<td style=\"width: 200px\">"+obj.qtSendTime+"</td>"+
		                        "<td style=\"width: 90px\">"+
		                            "<a title=\"编辑\" onclick=\"bjst(this,2,'"+obj.qtId+"','"+obj.teaId+"')\"><i class=\"fa fa-pencil\"></i></a>"+
		                            "&nbsp;"+
		                            "<a title=\"删除\" onclick=\"shanchu('"+obj.qtId+"','"+obj.teaId+"')\"><i class=\"fa fa-trash-o\"></i></a>"+
		                        "</td>"+
		                    "</tr>"+
		                    "<tr style=\"height: 5px\"></tr>");
  	
		    	});     
	    	 $("#shitk .stbt tr").mousemove(function(){
	             $(this).addClass("bgbk");
	         });
	         
	         $("#shitk .stbt tr").mouseout(function(){
	             $(this).removeClass("bgbk");
	         });
	         
	         $("#shitk .stbt tr").click(function(){
	             var a=$(this).find("input[type=checkbox]").prop("checked");
	             if(a==true){
	                 $(".cks").prop("checked",false);
	                 $(this).find("input[type=checkbox]").prop("checked",false);
	                 $(this).removeClass("bgbk2");
	             }else{
	                 $(this).find("input[type=checkbox]").prop("checked",true);
	                 $(this).addClass("bgbk2");
	             }
	         });
	    	
	      })
    }
    
    //删除试题
    function shanchu(qtid,yhid){
    	var uid=$(".uid").html();
    	if(uid==yhid){
    		 if(confirm("确定要删除吗？")){
		    	 $.ajax({
						type:"put",
						url:"sctm/"+qtid,
						contentType:"application/json",
						data:{"qtid":qtid},  //单个简单参数
						//data: JSON.stringify(data),//对象参数，只能是一个，对应@RequestBody
						success:function(data){ 
							alert("删除成功");
							cxstk(1);
						},
						error:function(xhr){
							alert(xhr.responseText);
						}
					});
				}
	    }else{
	    	alert("只能删除自己发布的题目！")
	    }
    }
    
    function bjst(th,zt,qtid,yhid){
    	var uid=$(".uid").html();
    	if(uid==yhid){
    	   $("#bjsj").hide();
           $("#shouye").hide();
           $("#tjst").show();
           $("#shitk").hide();
           $("#cjks").hide();
           $("#shijk").hide();
           $("#bjks").hide();
           $("#tjst .lrst").attr("zt",zt);
           var type=$(th).parent().prev().prev().prev().prev().prev().html();
           if(type=="多选"){
        	   $(".stlx").val(2);
           }
           cxtm(qtid);
           cxxx(qtid,type);
           cxjx(qtid,uid);
    	}else{
    		alert("只能编辑自己发布的试题");
    	}    
    }
    
    function cxtm(qtid){
    	 $.getJSON("cxdgst/"+qtid,function(date){
  			$(".tigan").val(date.qtQuest);
  			$(".tigan").attr("tmid",qtid);
  			$(".tmlx input").attr("zsdid",date.knowId);
  		 });
    }
    
    function cxxx(qtid,type){
    	$(".mrxx").html("");
    	var i=0;
    	var lx="radio";
    	if(type=="多选"){
    		lx="checkbox";
    	}
   	 $.getJSON("cxxx/"+qtid,function(date){
 			$.each(date,function(){
 				var sfxz="";
 				if(this.isRight==1){ 					
 					sfxz="checked";
 				}
 				
 				if(i>1){
 					$(".mrxx").append(" <div class=\"xuanx\">"+
 	 		                "<div><input type=\""+lx+"\"  name='y' "+sfxz+"></div>"+
 	 		                "<textarea class=\"xuanxiang\" onfocus=\"srxx(this)\" onblur=\"xxwc(this)\" xxid='"+this.opId+"'>"+this.rightOption+"</textarea>"+
 	 		              	"<div class=\"qxxx\" onclick=\"scxx(this)\">x</div>"+
 	 		                "</div>");
 				}else{
 					$(".mrxx").append(" <div class=\"xuanx\">"+
 		                "<div><input type=\""+lx+"\" name='y' "+sfxz+"></div>"+
 		                "<textarea class=\"xuanxiang\" onfocus=\"srxx(this)\" onblur=\"xxwc(this)\" xxid='"+this.opId+"'>"+this.rightOption+"</textarea>"+
 		               "</div>");
 				}
 							
 				i++;
 			})
 		 });
   }
    
    function cxjx(qtid,uid){
   	 $.getJSON("cxjx/"+qtid+"/"+uid,function(date){
 			$(".jiexi").val(date.analyzeContent);
 			$(".jiexi").attr("jxid",date.analyzeId);
 		 });
   }

    //查询考试模板
    function cxksmb(){
    	$(".xskxmb").html("  <tr>"+
                "<td>模板名称</td>"+
                "<td style=\"width: 120px;\">考试范围</td>"+
                "<td>所属年级</td>"+
                "<td>每题分数</td>"+
                "<td>考试用时</td>"+
                "<td>创建人</td>"+
            "</tr>");
    	 $.getJSON("cxksmb",function(date){
  			$.each(date,function(){
  				$(".xskxmb").append(" <tr mbid='"+this.eqId+"'>"+
                        "<td class=\"mobanmc\">"+this.epName+"</td>"+
                        "<td><div class='mbmc' title='"+this.testRange+"'>"+this.testRange+"<div></td>"+
                        "<td>"+this.gName+"</td>"+
                        "<td>"+this.score+"</td>"+
                        "<td>"+this.testTime+"</td>"+
                        "<td>"+this.teaName+"</td>"+
                    "</tr>");
  			});
  			
  			 $(".xskxmb tr:gt(0)").click(function(){
  	             $(".xskxmb tr:gt(0)").css("background-color","#FFFFFF");
  	             $(".xskxmb tr:gt(0)").css("color","#1A2226");
  	             $(this).css("background-color","red");
  	             $(this).css("color","#FFFFFF");
  	             var mbmc=$(this).find(".mobanmc").html();
  	             $(".ssmb input[type=text]").val(mbmc);
  	             var mbid=$(this).attr("mbid");
  	             $(".ssmb input[type=text]").attr("mbid",mbid);
  	         });
  		 });
    	   	
    }
    
    //范围课程
    function fwkc(id,name){
    	$(".ksfw input").val(name);
    	$(".ksfw input").attr("kcid",id);
    	$(".ksfw input").attr("zjid",0);
    	$(".ksfw input").attr("zsdid",0);
    	cxsybook();
    	$(".zsdtm .sb").val(id);
    	//$(".zsdtm .sb").attr("disabled",true);
    	cxzj(id);
    }
    
  	//范围章节
    function fwzj(kcid,kcmc,zjid,zjmc){
    	$(".ksfw input").val(zjmc);
    	$(".ksfw input").attr("kcid",kcid);
    	$(".ksfw input").attr("zjid",zjid);
    	$(".ksfw input").attr("zsdid",0);
    	cxsybook();
    	$(".zsdtm .sb").val(kcid);  	
    	fwzjxz(kcid,zjid); 	
    	cxzsd(zjid);
    }
  	function fwzjxz(bookId,zjid){
  		$(".zsdtm .zsd").html("<option value=\"0\">选择章节</option>");
  		 $.ajaxSettings.async = false;
  		 $.getJSON("cxCourse/"+bookId,function(date){
    			$.each(date,function(){
    				$(".zsdtm .zj").append("<option value=\"" +this.courseId+ "\">"
                          + this.courseName+ "</option>")
    			});
    		 });
  		 
 		$(".zsdtm .zj").val(zjid);
    	//$(".zsdtm .zj").attr("disabled",true);
  	}
  	
  	//范围知识点
	function fwzsd(kcid,kcmc,zjid,zjmc,zsdid,zsdmc){
		$(".ksfw input").val(zsdmc);	
		$(".ksfw input").attr("kcid",kcid);
    	$(".ksfw input").attr("zjid",zjid);
    	$(".ksfw input").attr("zsdid",zsdid);
		$(".zsdtm .sb").val(kcid);
    	
		fwzjxz(kcid,zjid); 	
    	
		fwzsdxz(zjid,zsdid);
    	
    }	
  	function fwzsdxz(courseId,zsdid){
  		$(".zsdtm .zsd").html("<option value=\"0\">选择章节</option>");
  			$.ajaxSettings.async = false;
 		    $.getJSON("cxKnowledge/"+courseId,function(date){
   			$.each(date,function(){
   				$(".zsdtm .zsd").append("<option value=\"" +this.knowId+ "\">"
                         + this.knowName + "</option>")
   			});
   		 });
 		    
 		   $(".zsdtm .zsd").val(zsdid);

  	}
  	
  	//查询所有课程
  	function cxsybook(){
  		$(".zsdtm .sb").html("<option value=\"0\">选择课程</option>");
  		$.ajaxSettings.async = false; 
  		$.getJSON("cxsyBook",function(date){
  			$.each(date,function(){
  				$(".zsdtm .sb").append("<option value=\"" +this.bookId+ "\">"
                        + this.bookName + "</option>")
  			});
  		 });
  	}
  	
  	//试卷预览
  	function shijuanyl(th){
  		var a=$("#shijk .sjbsj input");
  		var b=0;
  		var sjid=0;
  		for(var i=0;i<a.length;i++){
  			if($(a[i]).prop("checked")==true){
  				sjid=$(a[i]).attr("sjid");
  				b++;
  			}
  		}
  		if(b>1){
  			alert("一次只能选择一张试卷预览");
  		}else if(b==1){
  			$.getJSON("bcsjid/"+sjid,function(date){
  				location.href="sjyl";
  			})
  		}else{
  			alert("请先选择一张试卷预览");
  		}
  	}
  	
  //查询课程
  	function cxbooks(gId){
  		$(".zsdtm .sb").html("<option value=\"0\">选择课程</option>");
  		 $.ajaxSettings.async = false;
  		 $.getJSON("cxBook/"+gId,function(date){
  			$.each(date,function(){
  				$(".zsdtm .sb").append("<option value=\"" +this.bookId+ "\">"
                        + this.bookName + "</option>")
  			});
  		 });
  	}
  	
  	//查询章节
  	function cxzj(bookId){
  		$(".zsdtm .zj").html("<option value=\"0\">选择课程</option>");
  		 $.getJSON("cxCourse/"+bookId,function(date){
   			$.each(date,function(){
   				$(".zsdtm .zj").append("<option value=\"" +this.courseId+ "\">"
                         + this.courseName+ "</option>")
   			});
   		 });
  	}
  	
  	//查询知识点
  	function cxzsd(courseId){
  		$(".zsdtm .zsd").html("<option value=\"0\">选择章节</option>");
  		 $.ajaxSettings.async = false;
  		 $.getJSON("cxKnowledge/"+courseId,function(date){
    			$.each(date,function(){
    				$(".zsdtm .zsd").append("<option value=\"" +this.knowId+ "\">"
                          + this.knowName + "</option>")
    			});
    		 });
  	}
  	
  	//三级联动
  	function  xsctzsd(gId){
  		 $(".ctfw .shuml").html("");
		 $.getJSON("cxBook/"+gId,function(date){
			 $.each(date,function(i,objb){
				 var li = $(" <li>"+
				            "<i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label bookId=\""+this.bookId+"\">📚 "+this.bookName+"</label>"+
				             "<ul class=\"zjml\"></ul></li>");
				 $(".ctfw .shuml").append(li);
				  $.each(this.listc,function(i,obj){
						var li2 = $("<li><i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label courseId='"+this.courseId+"'>📃"+obj.courseName+"</label>"+
			                       " <ul class=\"zsdml\">"+
		                           "</ul> </li>");
						li.find(".zjml").append(li2);

	                   $.each(obj.listk,function(i,objk){
	                    	   li2.find(".zsdml").append( " <li>"+
	                           " <label knowId='"+objk.knowId+"' onclick=\"xzzsd(this,'"+objk.knowName+"','"+objk.knowId+"')\">📑  "+objk.knowName,+"</label></li>");

	               		});
				 }) 
			 })
		 });
  	}
  	
  	//换试卷的知识点
	function  ghzsd(zsdid,sjid){
		
 		 $(".stfw .shuml").html("");
 		 
 		 $.getJSON("cxBooks",function(date){
 			 
			 $.each(date,function(i,objb){
				 var li=$("<li>"+
				            "<i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label bookId=\""+this.bookId+"\" >📚 "+this.bookName+"</label>"+
			             "<ul class=\"zjml\"></ul></li>");
				 $(".stfw .shuml").append(li);
				 
				  $.each(this.listc,function(is,obj){
					  var li2=$("<li>"+
		                    "<i class=\"fa fa-plus-square-o\" onclick=\"dj(this)\"></i> <label courseId='"+obj.courseId+"' >📃"+obj.courseName+"</label>"+
		                    "<ul class=\"zsdml\"></ul></li>")
						li.find(" .zjml").append(li2);
		                    
	                $.each(obj.listk,function(ik,objk){
	                	if(objk.knowId==zsdid){
	                		
	                	}else{
	                		
	                    	 li2.find(".zsdml").append( " <li>"+
	                         " <label knowId='"+objk.knowId+"' onclick=\"ghsjzsd('"+objk.knowId+"','"+zsdid+"','"+sjid+"')\">📑  "+objk.knowName+"</label></li>");
	                	}
	                });
				 });
			 });
			 
			 $(".stfw .zsdml li label").click(function(){
	                $(".stfw .shuml li label").css("border-color","#7c7c7cbd");
	                $(".stfw .shuml li label").css("background-color","white");
	                $(this).css("background-color","#f4d2ca");
	                $(this).css("border-color","#ff5600");
	            });			 
		 });
		 
		 $(".stfw").show();
         $(".cyy").show();
 	}
  	
  	function ghsjzsd(xzsdid,jzsdid,sjid){
  		alert(jzsdid);
  		var sum=0;
  		var a=$("#zsdlb .zsdzl");
  		for(var i=0;i<a.length;i++){
  			if($(a[i]).attr("zsdid")==jzsdid){
  				sum=$(a[i]).find("input").val();
  				break;
  			}
  		}
  		
  		$.getJSON("ghsjzsd/"+jzsdid+"/"+xzsdid+"/"+sum+"/"+sjid,function(date){
  			
	  			cxsjtmzsd(sjid);		
	  			alert("更换成功！");
  		})
  	}
  	
  	
  	//查询即将开始的考试
  	function cxjjksdks(pageSize){
  		/* var today;
        today = new Date();
        intYears = today.getFullYear(); //得到年份,getFullYear()比getYear()更普适
        intMonths = today.getMonth() + 1; //得到月份，要加1
        intDays = today.getDate(); //得到日期
        intHours = today.getHours(); //得到小时 
        intMinutes = today.getMinutes(); //得到分钟
        if(intMonths<10){
        	intMonths="0"+intMonths;
        }
        if(intDays<10){
        	intDays="0"+intDays;
        }
        if(intHours<10){
        	intHours="0"+intHours;
        }
        if(intMinutes<10){
        	intMinutes="0"+intMinutes;
        }
        var time=intYears+"-"+intMonths+"-"+intDays+" "+intHours+":"+intMinutes; */
        
        $(".jjks").html("");
        
        $.getJSON("cxwkks?pageSize="+pageSize,function(date){
        	
        	$.each(date.list,function(){
        		
        		
        		var min1=parseInt(this.endTime.substr(11,2))*60+parseInt(this.endTime.substr(14,2));
        		var min2=parseInt(this.startTime.substr(11,2))*60+parseInt(this.startTime.substr(14,2));
        		var n=min1-min2;
        		
        		$(".jjks").append("<div class=\"zzjxsj\" onmouseover=\"sjxs(this)\" onmouseout=\"sjxx(this)\">"
                        +"<h3 class=\"sysjmc\" ksid='"+this.examId+"' fbr='"+this.teaId+"' sjid='"+this.examPaperId+"'>"+this.paperName+"</h3>"
                        +"<p class=\"sykssj\">考试时间："+this.startTime+"</p>"
                        +"<p class=\"sysjfs\">试卷总分："+this.zscore+"</p>"
                        +"<p class=\"sysjlx\">考试时长："+n+"</p>"
                        +"<p class=\"sykssc\">题目数量："+this.tmsum+"</p>"
                        +"<div style=\"width: 260px;text-align: center;font-size: 15px\">"
                        +"<a onclick=\"bjks(this)\" zt='2'><i class=\"fa fa-pencil\"></i>编辑</a>"
                        +" </div></div>");
        	});
        	
        })
        
        var i=$(".jjks .zzjxsj");
        if(i.length<1){
        	$(".jjks").html("<div style=\"margin: 60px 0 50px 400px;color: #8c8c8c;\">还没有即将开始的考试，点击上方创建一场考试吧~~</div>");
        }
        
      	//每秒执行一次,showTime()  
        setTimeout("cxjjksdks(3)",60000);  
  	}
  	
  	function cxzzjxks(pageSize){

        
        $(".zzjx").html("");
        
        $.getJSON("cxzzjxks?pageSize="+pageSize,function(date){
        	
        	$.each(date.list,function(){
        		
        		var min1=parseInt(this.endTime.substr(11,2))*60+parseInt(this.endTime.substr(14,2));
        		var min2=parseInt(this.startTime.substr(11,2))*60+parseInt(this.startTime.substr(14,2));
        		var n=min1-min2;
        		
        		$(".zzjx").append("<div class=\"zzjxsj\" onmouseover=\"sjxs(this)\" onmouseout=\"sjxx(this)\">"
                        +"<h3 class=\"sysjmc\">"+this.paperName+"</h3>"
                        +"<p class=\"sykssj\">考试时间："+this.startTime+"</p>"
                        +"<p class=\"sysjfs\">试卷总分："+this.zscore+"</p>"
                        +"<p class=\"sysjlx\">考试时长："+n+"</p>"
                        +"<p class=\"sykssc\">题目数量："+this.tmsum+"</p>"                   
                        +"</div>");
        	});
        	
        })
  			$(".zzjx").append("<div class=\"clear\"></div>");
        
  		var i=$(".zzjx .zzjxsj");
        if(i.length<1){
        	
  			$(".zzjx").html("<div style=\"margin: 60px 0 50px 400px;color: #8c8c8c;\">还没有正在进行的考试，点击上方创建一场考试吧~~</div>")
        }
        
       setTimeout("cxzzjxks(3)",60000);  
  }
  	
	//选择已有模板
  function	ymbcjsj(th){
  		var epId= $(".ssmb input[type=text]").attr("mbid");		
  		var param={'epId':epId,'paperName':$(".cjxsj .sjmc").val(),'createPerson':$(".uid").html(),'lastUpdPerson':$(".uid").html()};
  		//新增试卷
  		$.ajax({
			type:"POST",
			url:"xzsj",
			dataType:"json",
		    contentType:"application/json",
			data:JSON.stringify(param),
			success:function(res){					
				xzsjtms(res);
			}
		}); 
  		
  		
  	
  	}
  
	//查询模板中的知识点
  function xzsjtms(epId){
				
  		$.getJSON("cxsjmb/"+mbid,function(date){
  			$.each(date,function(){
  				var dx={'qtId':this.knowId,'examId':count};
				param.push(dx);
				
				xztm2(this.kmowId,this.count,epId);
				
  			})
  		})
  }
  
	//新增试卷题目
  function xztm2(zsdid,sum,examId){
	  var param=[]; 
	  $.ajaxSettings.async = false;
		$.getJSON("cxsjtm/"+zsdid+"/"+sum,function(date){
			$.each(date,function(){
				var dx={'qtId':this.qtId,'examId':examId};
				param.push(dx);
			});
			
		})
		
	console.info(JSON.stringify(param));
	  $.ajax({
		type:"POST",
		url:"xzsjtm",
		dataType:"json",
	    contentType:"application/json",
		data:JSON.stringify(param),
		success:function(res){	
			cxsjxx(examId);
			
			$(".div1").css("display","none");
	        $(".xtzj").css("display","none");
	        $(".fbks").css("display","flex");
	        $(".cjksbz a").css("color","#999999")
	        $(".cjksbz .dsb").css("color","blue")
		}
	}); 
  }
	
	function cxbj(th){
		$(th).prev().val("");
	}
	
	function bcxg(){
		var ksbj=$("#bjks .ksfl input").attr("bjid");
		var sj=$("#bjks .kssj").val();
    	var sj2=sj.replace(/T/," ");
    	var js=$("#bjks .jssj").val();
    	var js2=js.replace(/T/," "); 
    	var sjid=$("#bjks .fbsjmc").attr("sjid");

    	var param={'examPaperId':sjid,'classId':ksbj,'teaId':$(".uid").html(),'startTime':sj2,'endTime':js2,'examId':$("#bjks .fbsjmc").attr("ksid")}; 
    	
    	 $.ajax({
    			type:"POST",
    			url:"xgksxx",
    			dataType:"json",
    		    contentType:"application/json",
    			data:JSON.stringify(param),
    			success:function(res){	
    				
    				alert("修改成功！");
    			}
    		}); 
    	
	}
  </script>;
</body>
</html>